<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Texas Aerial Robotics Documentation: simulations_ros</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Texas Aerial Robotics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__home_eric_catkin_ws_src_simulations_ros_README.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">simulations_ros </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Repositoy for our sim</p>
<p>steps for installing</p>
<h2>1. Install ROS</h2>
<p>First, install <b>ROS Kinetic</b> using the following instructions: <a href="http://wiki.ros.org/kinetic/Installation/Ubuntu">http://wiki.ros.org/kinetic/Installation/Ubuntu</a></p>
<p>Do <em>Desktop Install</em></p>
<p>Make sure to follow all the way through the installation (until <em>Step 1.7</em> at the end of the page)</p>
<h2>2. Set Up Catkin workspace</h2>
<p>We use catkin build instead of catkin_make. Please install the following: </p><div class="fragment"><div class="line">sudo apt-get install python-wstool python-rosinstall-generator python-catkin-tools</div></div><!-- fragment --><p>Then, initialize the catkin workspace: </p><div class="fragment"><div class="line">mkdir -p ~/catkin_ws/src</div><div class="line">cd ~/catkin_ws</div><div class="line">catkin init</div><div class="line">catkin config --extend /opt/ros/kinetic</div><div class="line">catkin config --cmake-args -DCMAKE_BUILD_TYPE=Release</div><div class="line">catkin config --merge-devel</div></div><!-- fragment --><h2>3. Dependencies installation (catkin_make)</h2>
<div class="fragment"><div class="line">sudo apt-get install ros-kinetic-mavlink</div><div class="line">sudo apt-get install ros-kinetic-geographic-msgs</div><div class="line">sudo apt-get install ros-kinetic-move-base-msgs</div><div class="line">sudo apt-get install ros-kinetic-control-toolbox</div><div class="line">cd ~/catkin_ws/src</div><div class="line">git clone https://github.com/mavlink/mavros.git</div><div class="line">git clone https://github.com/AkellaSummerResearch/tf_publisher</div></div><!-- fragment --><h2>4. Clone our ROS package repositories</h2>
<div class="fragment"><div class="line">cd ~/catkin_ws/src </div><div class="line">git clone https://github.com/AkellaSummerResearch/simulations_ros.git</div></div><!-- fragment --><h2>5. Make instructions</h2>
<p>Inside <code>catkin_ws</code>, run <code>catkin_make</code></p>
<div class="fragment"><div class="line">cd ~/catkin_ws </div><div class="line">catkin_make </div></div><!-- fragment --><h2>6. Install Gazebo</h2>
<p>Setup your computer to accept software from <a href="http://packages.osrfoundation.org:">http://packages.osrfoundation.org:</a> </p><div class="fragment"><div class="line">sudo sh -c &#39;echo &quot;deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main&quot; &gt; /etc/apt/sources.list.d/gazebo-stable.list&#39;</div></div><!-- fragment --><p>Setup keys: </p><div class="fragment"><div class="line">wget http://packages.osrfoundation.org/gazebo.key -O - | sudo apt-key add - </div></div><!-- fragment --><p>Reload software list: </p><div class="fragment"><div class="line">sudo apt-get update</div></div><!-- fragment --><p>Install Gazebo: </p><div class="fragment"><div class="line">sudo apt-get install gazebo7 libgazebo7-dev</div></div><!-- fragment --><p>Install ROS plugins: </p><div class="fragment"><div class="line">sudo apt install ros-kinetic-gazebo-ros ros-kinetic-gazebo-plugins</div></div><!-- fragment --><p>Give permissions to your uses: </p><div class="fragment"><div class="line">sudo chown $USER .gazebo/</div></div><!-- fragment --><h2>6. Install Px4</h2>
<p>run ubuntu_sim_common_deps.sh </p><div class="fragment"><div class="line">cd ~/catkin_ws/src/simulations_ros/scripts/</div><div class="line">./ubuntu_sim_common_deps.sh</div><div class="line">sudo apt install libprotobuf-dev protobuf-compiler libignition-math2-dev</div><div class="line">cd ~/Firmware </div><div class="line">make posix_sitl_default gazebo</div></div><!-- fragment --> <h2>7. Add paths to .bashrc</h2>
<div class="fragment"><div class="line">export GAZEBO_MODEL_PATH=${GAZEBO_MODEL_PATH}:~/catkin_ws/src/simulations_ros/models</div><div class="line">export ROS_PACKAGE_PATH=$ROS_PACKAGE_PATH:~/Firmware</div><div class="line">export ROS_PACKAGE_PATH=$ROS_PACKAGE_PATH:~/Firmware/Tools/sitl_gazebo</div><div class="line">source ~/Firmware/Tools/setup_gazebo.bash ~/Firmware ~/Firmware/build/posix_sitl_default</div></div><!-- fragment --><p> source bashrc </p><div class="fragment"><div class="line">source ~/.bashrc</div></div><!-- fragment --><h2>8. Running Simulation</h2>
<p>move script to start <a class="el" href="namespacepx4.html">px4</a> sitl </p><div class="fragment"><div class="line">cp ~/catkin_ws/src/simulations_ros/scripts/startsim.sh ~</div></div><!-- fragment --><p>In first terminal </p><div class="fragment"><div class="line">./startsim.sh</div></div><!-- fragment --><p> In another terminal</p>
<div class="fragment"><div class="line">roslaunch simulations_ros px4.launch</div></div><!-- fragment --><p>If the previous command fails with</p>
<div class="fragment"><div class="line">[FATAL] [1538090263.500882984]: UAS: GeographicLib exception: File not readable /usr/share/GeographicLib/geoids/egm96-5.pgm | Run install_geographiclib_dataset.sh script in order to install Geoid Model dataset!</div></div><!-- fragment --><p>run </p><div class="fragment"><div class="line">cd catkin_ws/src/mavros/mavros/scripts/</div><div class="line">./install_geographiclib_datasets.sh</div></div><!-- fragment --><p>after a few seconds the drone will initialize and you can command the drone to takeoff. In the <a class="el" href="namespacepx4.html">px4</a> terminal run:</p>
<div class="fragment"><div class="line">commander takeoff</div></div><!-- fragment --><p>The camera window will pop up. If you close it and want to reopen, type: </p><div class="fragment"><div class="line">rosrun image_view image_view image:=/stereo/camera/left/image_raw</div></div><!-- fragment --><h2>9. Remove GPS noise in PX4</h2>
<p>In the terminal that is running <a class="el" href="namespacepx4.html">px4</a>, run the following:</p>
<div class="fragment"><div class="line">param set EKF2_GPS_P_NOISE 0.01</div><div class="line">param set EKF2_GPS_V_NOISE 0.1</div><div class="line">param set EKF2_BARO_NOISE 0.5</div><div class="line">param set EKF2_GPS_DELAY 0</div></div><!-- fragment --><p>PX4 should save these parameters. The next time you run PX4, the parameters should be set to the ones above. To make sure they are right, run the following in PX4's terminal:</p>
<div class="fragment"><div class="line">param show EKF2_GPS_P_NOISE</div><div class="line">param show EKF2_GPS_V_NOISE</div><div class="line">param show EKF2_BARO_NOISE</div><div class="line">param show EKF2_GPS_DELAY</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
